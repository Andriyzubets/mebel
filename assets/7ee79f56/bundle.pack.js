!function(e){var n,t={NOT_RESOLVED:"NOT_RESOLVED",IN_RESOLVING:"IN_RESOLVING",RESOLVED:"RESOLVED"},r=function(){var f={trackCircularDependencies:!0,allowMultipleDeclarations:!0},p={},l=!1,v=[],E=function(e,r,o){o||(o=r,r=[]);var a=p[e];a||(a=p[e]={name:e,decl:n}),a.decl={name:e,prev:a.decl,fn:o,state:t.NOT_RESOLVED,deps:r,dependents:[],exports:n}},h=function(n,t,r){"string"==typeof n&&(n=[n]),l||(l=!0,d(N)),v.push({deps:n,cb:function(n,a){a?(r||o)(a):t.apply(e,n)}})},m=function(e){var n=p[e];return n?t[n.decl.state]:"NOT_DEFINED"},g=function(e){return!!p[e]},O=function(e){for(var n in e)e.hasOwnProperty(n)&&(f[n]=e[n])},D=function(){var e,n={};for(var t in p)p.hasOwnProperty(t)&&(e=p[t],(n[e.decl.state]||(n[e.decl.state]=[])).push(t));return n},N=function(){l=!1,y()},y=function(){var e,n=v,t=0;for(v=[];e=n[t++];)L(null,e.deps,[],e.cb)},L=function(e,n,t,r){var o=n.length;o||r([]);for(var i,s,u=[],c=function(e,n){if(n)return void r(null,n);if(!--o){for(var t,a=[],i=0;t=u[i++];)a.push(t.exports);r(a)}},d=0,f=o;d<f;){if(i=n[d++],"string"==typeof i){if(!p[i])return void r(null,a(i,e));s=p[i].decl}else s=i;u.push(s),S(s,t,c)}},S=function(n,r,o){if(n.state===t.RESOLVED)return void o(n.exports);if(n.state===t.IN_RESOLVING)return void(f.trackCircularDependencies&&c(n,r)?o(null,i(n,r)):n.dependents.push(o));if(n.dependents.push(o),n.prev&&!f.allowMultipleDeclarations)return void _(n,u(n));f.trackCircularDependencies&&(r=r.slice()).push(n);var a=!1,d=n.prev?n.deps.concat([n.prev]):n.deps;n.state=t.IN_RESOLVING,L(n,d,r,function(t,r){return r?void _(n,r):(t.unshift(function(e,t){return a?void o(null,s(n)):(a=!0,void(t?_(n,t):R(n,e)))}),void n.fn.apply({name:n.name,deps:n.deps,global:e},t))})},R=function(e,r){e.exports=r,e.state=t.RESOLVED;for(var o,a=0;o=e.dependents[a++];)o(r);e.dependents=n},_=function(e,n){e.state=t.NOT_RESOLVED;for(var r,o=0;r=e.dependents[o++];)r(null,n);e.dependents=[]};return{create:r,define:E,require:h,getState:m,isDefined:g,setOptions:O,getStat:D}},o=function(e){d(function(){throw e})},a=function(e,n){return Error(n?'Module "'+n.name+'": can\'t resolve dependence "'+e+'"':'Required module "'+e+"\" can't be resolved")},i=function(e,n){for(var t,r=[],o=0;t=n[o++];)r.push(t.name);return r.push(e.name),Error('Circular dependence has been detected: "'+r.join(" -> ")+'"')},s=function(e){return Error('Declaration of module "'+e.name+'" has already been provided')},u=function(e){return Error('Multiple declarations of module "'+e.name+'" have been detected')},c=function(e,n){for(var t,r=0;t=n[r++];)if(e===t)return!0;return!1},d=function(){var n=[],t=function(e){return 1===n.push(e)},r=function(){var e=n,t=0,r=n.length;for(n=[];t<r;)e[t++]()};if("object"==typeof process&&process.nextTick)return function(e){t(e)&&process.nextTick(r)};if(e.setImmediate)return function(n){t(n)&&e.setImmediate(r)};if(e.postMessage&&!e.opera){var o=!0;if(e.attachEvent){var a=function(){o=!1};e.attachEvent("onmessage",a),e.postMessage("__checkAsync","*"),e.detachEvent("onmessage",a)}if(o){var i="__modules"+ +new Date,s=function(e){e.data===i&&(e.stopPropagation&&e.stopPropagation(),r())};return e.addEventListener?e.addEventListener("message",s,!0):e.attachEvent("onmessage",s),function(n){t(n)&&e.postMessage(i,"*")}}}var u=e.document;if("onreadystatechange"in u.createElement("script")){var c=u.getElementsByTagName("head")[0],d=function(){var e=u.createElement("script");e.onreadystatechange=function(){e.parentNode.removeChild(e),e=e.onreadystatechange=null,r()},c.appendChild(e)};return function(e){t(e)&&d()}}return function(e){t(e)&&setTimeout(r,0)}}();"object"==typeof exports?module.exports=r():e.modules=r()}("undefined"!=typeof window?window:global);
modules.define("BH",function(t){var e=function(){function t(){this._lastMatchId=0,this._matchers=[],this._infiniteLoopDetection=!1,this.lib={},this._shortTags={};for(var t=0;t<o.length;t++)this._shortTags[o[t]]=1;this._options={},this._optJsAttrName="onclick",this._optJsAttrIsJs=!0,this._optJsCls="i-bem",this._optJsElem=!0,this._optEscapeContent=!1,this._optNobaseMods=!1,this._optDelimElem="__",this._optDelimMod="_",this._optShortTagCloser="/>",this.utils={_expandoId:(new Date).getTime(),bh:this,isSimple:function(t){if(!t||t===!0)return!0;var e=typeof t;return"string"===e||"number"===e},extend:function(t){t&&"object"==typeof t||(t={});for(var e=1,o=arguments.length;e<o;e++){var n,i=arguments[e];if(i)for(n in i)t[n]=i[n]}return t},position:function(){var t=this.node;return"content"===t.index?1:t.position},isFirst:function(){var t=this.node;return"content"===t.index||1===t.position},isLast:function(){var t=this.node;return"content"===t.index||t.position===t.arr._listLength},tParam:function(t,e,o){var n="__tp_"+t,i=this.node;if(arguments.length>1)return!o&&this.tParam(t)||(i[n]=e),this;for(;i;){if(i.hasOwnProperty(n))return i[n];i=i.parentNode}},process:function(t){var e=this.ctx,o=this.node,n=this.bh.processBemJson(t,e.block);return this.ctx=e,this.node=o,n},applyBase:function(){var t=this.node,e=t.json,o=e.block,n=e.mods,i=this.bh._fastMatcher(this,e);return void 0!==i&&(this.ctx=t.arr[t.index]=t.json=i,t.block=o,t.mods=n),this},stop:function(){return this.ctx._stop=!0,this},generateId:function(){return"uniq"+this._expandoId+ ++e},mod:function(t,e,o){var n=this.ctx.elem?"elemMods":"mods";if(arguments.length>1){var i=this.ctx[n];return i[t]=!i.hasOwnProperty(t)||o?e:i[t],this}return this.ctx[n][t]},mods:function(t,e){var o=this.ctx.elem?"elemMods":"mods",n=this.ctx[o];return void 0!==t?(this.ctx[o]=e?this.extend(n,t):this.extend(t,n),this):n},tag:function(t,e){return void 0===t?this.ctx.tag:((e||void 0===this.ctx.tag)&&(this.ctx.tag=t),this)},mix:function(t,e){return void 0===t?this.ctx.mix:(this.ctx.mix=e||!this.ctx.mix?t:(Array.isArray(this.ctx.mix)?this.ctx.mix:[this.ctx.mix]).concat(t),this)},attr:function(t,e,o){var n;return arguments.length>1?(n=this.ctx.attrs||(this.ctx.attrs={}),n[t]=!n.hasOwnProperty(t)||o?e:n[t],this):(n=this.ctx.attrs,n?n[t]:void 0)},attrs:function(t,e){var o=this.ctx.attrs||{};return void 0===t?o:(this.ctx.attrs=e?this.extend(o,t):this.extend(t,o),this)},bem:function(t,e){return void 0===t?this.ctx.bem:((e||void 0===this.ctx.bem)&&(this.ctx.bem=t),this)},js:function(t,e){var o=this.ctx;return void 0===t?o.js:(e||void 0===o.js?o.js=t:o.js!==!1&&(o.js=this.extend(o.js,t)),this)},cls:function(t,e){return void 0===t?this.ctx.cls:((e||void 0===this.ctx.cls)&&(this.ctx.cls=t),this)},param:function(t,e,o){return void 0===e?this.ctx[t]:((o||void 0===this.ctx[t])&&(this.ctx[t]=e),this)},content:function(t,e){return void 0===t?this.ctx.content:((e||void 0===this.ctx.content)&&(this.ctx.content=t),this)},html:function(t,e){return void 0===t?this.ctx.html:((e||void 0===this.ctx.html)&&(this.ctx.html=t),this)},json:function(){return this.ctx}}}var e=0;t.prototype={constructor:t,setOptions:function(t){var e;for(e in t)this._options[e]=t[e];if(t.jsAttrName&&(this._optJsAttrName=t.jsAttrName),t.jsAttrScheme&&(this._optJsAttrIsJs="js"===t.jsAttrScheme),void 0!==t.jsCls&&(this._optJsCls=t.jsCls),t.hasOwnProperty("jsElem")&&(this._optJsElem=t.jsElem),t.clsNobaseMods&&(this._optNobaseMods=!0),t.escapeContent&&(this._optEscapeContent=t.escapeContent),t.delimElem&&(this._optDelimElem=t.delimElem),t.delimMod&&(this._optDelimMod=t.delimMod),t.xhtml===!1&&(this._optShortTagCloser=">"),t.shortTags)for(var o=0;o<t.shortTags.length;o++)this._shortTags[t.shortTags[o]]=1;return this},getOptions:function(){return this._options},enableInfiniteLoopDetection:function(t){return this._infiniteLoopDetection=t,this},apply:function(t){return this.toHtml(this.processBemJson(t))},match:function(t,e){if(!t)return this;if(Array.isArray(t))return t.forEach(function(o,n){this.match(t[n],e)},this),this;if("object"==typeof t){for(var o in t)this.match(o,t[o]);return this}return e.__id="__func"+this._lastMatchId++,this._matchers.push([t,e]),this._fastMatcher=null,this},beforeEach:function(t){return this.match("$before",t)},afterEach:function(t){return this.match("$after",t)},buildMatcher:function(){function t(t,e){for(var o={},n=0,i=t.length;n<i;n++){var s=t[n],r=s[e]||"__no_value__";(o[r]||(o[r]=[])).push(s)}return o}function e(t,e,o){t.push("json."+e+" = true;","subRes = _m"+o+"(ctx, json);",'if (subRes !== undefined) return (subRes || "");',"if (json._stop) return;")}var o,n,i,s,r,c,a,l,h=[],d=["bh = this"],m=this._matchers,u=[];for(o=m.length-1;o>=0;o--)c=m[o],r=c[0],d.push("_m"+o+" = ms["+o+"][1]"),s={fn:c[1],index:o},~r.indexOf(this._optDelimElem)?(a=r.split(this._optDelimElem),l=a[0].split(this._optDelimMod),s.block=l[0],l.length>1&&(s.blockMod=l[1],s.blockModVal=l[2]||!0),a=a[1].split(this._optDelimMod),s.elem=a[0],a.length>1&&(s.elemMod=a[1],s.elemModVal=a[2]||!0)):(a=r.split(this._optDelimMod),s.block=a[0],a.length>1&&(s.blockMod=a[1],s.blockModVal=a[2]||!0)),u.push(s);var p=t(u,"block"),f=p.$before,_=p.$after;if(_&&delete p.$after,h.push("var "+d.join(", ")+";","function applyMatchers(ctx, json) {","var subRes;"),f)for(delete p.$before,n=0,i=f.length;n<i;n++)s=f[n],e(h,s.fn.__id,s.index);h.push("switch (json.block) {");for(var b in p){h.push('case "'+b+'":');var g=t(p[b],"elem");h.push("switch (json.elem) {");for(var x in g){"__no_value__"===x?h.push("case undefined:"):h.push('case "'+x+'":');var v=g[x];for(n=0,i=v.length;n<i;n++){s=v[n];var j=s.fn,y=[];y.push("!json."+j.__id),s.elemMod&&y.push('json.elemMods && json.elemMods["'+s.elemMod+'"] === '+(s.elemModVal===!0||'"'+s.elemModVal+'"')),s.blockMod&&y.push('json.mods && json.mods["'+s.blockMod+'"] === '+(s.blockModVal===!0||'"'+s.blockModVal+'"')),h.push("if ("+y.join(" && ")+") {"),e(h,j.__id,s.index),h.push("}")}h.push("break;")}h.push("}","break;")}if(h.push("}"),_)for(n=0,i=_.length;n<i;n++)s=_[n],e(h,s.fn.__id,s.index);return h.push("};","return applyMatchers;"),h.join("\n")},processBemJson:function(t,e,o){function n(){this.ctx=null}if(null!=t){var i,s,r,c,a,l,h,d,m,u,p=[t],f=[{json:t,arr:p,index:0,block:e,mods:null}],_=this._fastMatcher||(this._fastMatcher=Function("ms",this.buildMatcher())(this._matchers)),b=!o,g=this._infiniteLoopDetection;n.prototype=this.utils;for(var x=new n;i=f.shift();){if(s=i.json,r=i.block,c=i.mods,Array.isArray(s)){for(a=0,l=0,h=s.length;a<h;a++)m=s[a],m!==!1&&null!=m&&"object"==typeof m&&f.push({json:m,arr:s,index:a,position:++l,block:r,mods:c,parentNode:i});s._listLength=l}else{var v,j=!1;if(s.elem?(r=s.block=s.block||r,s.elemMods||(s.elemMods=s.mods||{},s.mods=null),c=s.mods=s.mods||c):s.block&&(r=s.block,c=s.mods=s.mods||{}),"object"==typeof s){if(g){if(s.__processCounter=(s.__processCounter||0)+1,_.__processCounter=(_.__processCounter||0)+1,s.__processCounter>100)throw new Error('Infinite json loop detected at "'+s.block+(s.elem?this._optDelimElem+s.elem:"")+'".');if(_.__processCounter>1e3)throw new Error('Infinite matcher loop detected at "'+s.block+(s.elem?this._optDelimElem+s.elem:"")+'".')}u=void 0,s._stop||(x.node=i,x.ctx=s,u=_(x,s),void 0!==u&&(s=u,i.json=s,i.block=r,i.mods=c,f.push(i),j=!0))}if(!j&&b&&(v=s.content))if(Array.isArray(v)){var y;do{for(y=!1,a=0,h=v.length;a<h;a++)if(Array.isArray(v[a])){y=!0;break}y&&(s.content=v=v.concat.apply([],v))}while(y);for(a=0,l=0,h=v.length,d=h-1;a<h;a++)m=v[a],m!==!1&&null!=m&&"object"==typeof m&&f.push({json:m,arr:v,index:a,position:++l,block:r,mods:c,parentNode:i});v._listLength=l}else f.push({json:v,arr:s,index:"content",block:r,mods:c,parentNode:i})}i.arr[i.index]=s}return p[0]}},toHtml:function(t){this._buf="",this._html(t);var e=this._buf;return delete this._buf,e},_html:function(t){var e,o,c;if(t!==!1&&null!=t)if("object"!=typeof t)this._buf+=this._optEscapeContent?n(t):t;else if(Array.isArray(t))for(e=0,o=t.length;e<o;e++)c=t[e],c!==!1&&null!=c&&this._html(c);else{if(t.toHtml){var a=t.toHtml.call(this,t)||"";return void(this._buf+=a)}var l=t.bem!==!1;if("undefined"!=typeof t.tag&&!t.tag)return void(t.html?this._buf+=t.html:this._html(t.content));t.mix&&!Array.isArray(t.mix)&&(t.mix=[t.mix]);var h,d,m,u="",p="",f=!1;if(h=t.attrs)for(e in h)d=h[e],d===!0?p+=" "+e:d!==!1&&null!==d&&void 0!==d&&(p+=" "+e+'="'+i(d)+'"');if(l){var _=t.block+(t.elem?this._optDelimElem+t.elem:"");t.block&&(u=r(t,_,null,this._optNobaseMods,this._optDelimMod),t.js&&((m={})[_]=t.js===!0?{}:t.js));var b=this._optJsCls&&(this._optJsElem||!t.elem),g=t.mix;if(g&&g.length)for(e=0,o=g.length;e<o;e++){var x=g[e];if(x&&x.bem!==!1){var v=x.block||t.block||"",j=x.elem||(x.block?null:t.block&&t.elem),y=v+(j?this._optDelimElem+j:"");v&&(u+=r(x,y,_,this._optNobaseMods,this._optDelimMod),x.js&&((m=m||{})[y]=x.js===!0?{}:x.js,f=!0,b||(b=v&&this._optJsCls&&(this._optJsElem||!j))))}}if(m){b&&(u+=" "+this._optJsCls);var k=f||t.js!==!0?s(JSON.stringify(m)):'{"'+_+'":{}}';p+=" "+(t.jsAttr||this._optJsAttrName)+"='"+(this._optJsAttrIsJs?"return "+k:k)+"'"}}t.cls&&(u=(u?u+" ":"")+i(t.cls).trim());var M=t.tag||"div";this._buf+="<"+M+(u?' class="'+u+'"':"")+(p?p:""),this._shortTags[M]?this._buf+=this._optShortTagCloser:(this._buf+=">",t.html?this._buf+=t.html:this._html(t.content),this._buf+="</"+M+">")}}};var o="area base br col command embed hr img input keygen link menuitem meta param source track wbr".split(" "),n=t.prototype.xmlEscape=function(t){return(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},i=t.prototype.attrEscape=function(t){return(t+"").replace(/&/g,"&amp;").replace(/"/g,"&quot;")},s=t.prototype.jsAttrEscape=function(t){return(t+"").replace(/&/g,"&amp;").replace(/'/g,"&#39;")},r=function(t,e,o,n,i){var s,r,c,a="";if(o!==e&&(o&&(a+=" "),a+=e),s=t.elem&&t.elemMods||t.mods)for(c in s)r=s[c],(r||0===r)&&(a+=" "+(n?i:e+i)+c+(r===!0?"":i+r));return a};return t}();"undefined"!=typeof module&&(module.exports=e);var o=function(t){t.match("cart-widget-related-product",function(t,e){var o=[{elem:"box"},{elem:"image",image:e.data.image},{elem:"description",content:[{elem:"title",content:[{elem:"type",content:e.data.type},{elem:"name",content:e.data.title}]},{elem:"price-box",data:e.data.price}]},{elem:"action"}];t.js({rid:e.data.rid,pid:e.data.id,cid:e.data.cid}).content(o)}),t.match("cart-widget-related-product__image",function(t,e){return t.tag("img").attr("src",e.image,!0),{elem:"row",content:t.json()}}),t.match("cart-widget-related-product__price-box",function(t,e){return Array.isArray(e.data)?t.content([{elem:"price",mods:{type:"expired"},content:e.data[1]},{elem:"price",mods:{type:"actual"},content:e.data[0]},{elem:"price",mods:{type:"discount"},data:e.data}]):t.content([{elem:"price",mods:{type:"actual"},content:e.data}]),{elem:"row",content:t.content()}}),t.match("cart-widget-related-product__price",function(t,e){var o=t.content()+"",n=o.replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1 ");t.content(n,!0)}),t.match("cart-widget-related-product__price_type_discount",function(t,e){return!(e.data[0]>=e.data[1])&&(t.content(-1*Math.floor(100*(1-e.data[0]/e.data[1]))+"%",!0),{elem:"discount",content:t.json()})}),t.match("cart-widget",function(t,e){var o=(e.position||[]).map(function(o){return t.extend({},o,{block:"cart-widget-shopping-product",rid:e.rid})});t.content([{elem:"status-bar",js:{cid:e.cid}},{elem:"shopping-products",content:o},{elem:"summary",cid:e.cid,checkoutUrl:e.checkoutUrl},{elem:"related-products",js:{rid:e.rid,cid:e.cid}}],!0)}),t.match("cart-widget__summary",function(t,e){var o=[[{elem:"count",js:{cid:e.cid}},{elem:"cost",js:{cid:e.cid}}],{elem:"help",content:"После оформления заказа наш менеджер свяжется с Вами, чтобы уточнить все детали"},{elem:"checkout",js:{cid:e.cid},checkoutUrl:e.checkoutUrl}];t.content(o.map(function(t){return[{elem:"column",content:t}," "]}),!0)}),t.match("cart-widget__related-products",function(t,e){t.content([{elem:"title",mods:{"related-products":!0},content:"С этим товаром также покупают"},{elem:"row",mods:{"related-products":!0}}],!0)}),t.match("cart-widget__checkout",function(t,e){e.checkoutUrl&&t.tag("a",!0).attr("href",e.checkoutUrl)}),t.match("modal_type_dialog",function(t){t.content([{elem:"backdrop"},{elem:"dialog",content:[{elem:"close"},{elem:"content"}]}])}),t.match("modal_type_sidebar",function(t){t.content([{elem:"backdrop"},{elem:"sidebar",content:[{elem:"close"},{elem:"content"}]}])}),t.match("quick-buy",function(t){t.content([{elem:"backdrop"},{elem:"content"}])}),t.match("cart-widget-shopping-product",function(t,e){t.js({rid:e.rid}).tParam("isChildren",!!t.mod("children"),!0).content([{elem:"data",content:[{elem:"column",mods:{left:!0},content:[{elem:"image",data:e.image},{elem:"title",content:[{elem:"type",content:e.type},{elem:"name",content:e.title+(e.count&&e.count>1?" ("+e.count+"шт.)":"")}]}]}," ",{elem:"column",mods:{right:!0},content:[{elem:"price-box",data:e.price}]}]},{elem:"children",content:(e.children||[]).map(function(e){return t.extend({},e,{block:"cart-widget-shopping-product",mods:{children:!0}})})}],!0)}),t.match("cart-widget-shopping-product__children",function(t,e){var o=t.tParam("isChildren"),n=t.content();if(o||!n||!n.length)return!1}),t.match("cart-widget-shopping-product__image",function(t,e){var o=t.tParam("isChildren");return!o&&void(e.data?t.tag("img").attr("src",e.data,!0):t.mod("empty",!0))}),t.match("cart-widget-shopping-product__price-box",function(t,e){Array.isArray(e.data)?t.content([{elem:"price",mods:{type:"expired"},content:e.data[1]},{elem:"price",mods:{type:"actual"},content:e.data[0]},{elem:"price",mods:{type:"discount"},data:e.data}]):t.content([{elem:"price",mods:{type:"actual"},content:e.data}])}),t.match("cart-widget-shopping-product__price",function(t,e){var o=t.content()+"",n=o.replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1 ");t.content(n,!0)}),t.match("cart-widget-shopping-product__price_type_discount",function(t,e){return!(e.data[0]>=e.data[1])&&(t.content(-1*Math.floor(100*(1-e.data[0]/e.data[1]))+"%",!0),{elem:"discount",content:t.json()})}),t.match("ua",function(t){t.bem(!1).tag("script").content(["(function(e,c){",'e[c]=e[c].replace(/(ua_js_)no/g,"$1yes");','})(document.documentElement,"className");'],!0)})},n=new e;n.setOptions({jsAttrName:"data-bem",jsAttrScheme:"json"}),o(n),t(n)});
modules.define("i-bem-dom",["i-bem","i-bem__internal","i-bem-dom__collection","i-bem-dom__events_type_dom","i-bem-dom__events_type_bem","inherit","identify","objects","functions","jquery","dom"],function(t,e,n,i,o,r,s,a,c,d,u,f){function l(t,e,n){var i,o,r,s,a=t[0],c=v(a);for(i in c)n&&(o=i.split(O),r=o[0],s=o[1],s&&((n[r]||(n[r]={}))[s]=!0)),h(i,t,p(c[i],i,e))}function h(t,e,n,i,o){var r=e[0];if(!P[a(r)]){n||(n=p(y(r,t),t));var s=n.uniqId,d=x[s];if(d)return d.domElem.index(r)<0&&(d.domElem=d.domElem.add(e),c.extend(d.params,n)),d;D[s]=D[s]?D[s].add(e):e;var f=r.parentNode;f&&11!==f.nodeType||u.unique(D[s]);var l=m(t);return l._processInit(),!l.lazyInit||i||n.lazyInit===!1?(i&&e.addClass(S),d=new l(D[s],n,(!!i)),delete D[s],o&&o.apply(d,H.call(arguments,4)),d):void 0}}function m(t){if(B[t])return B[t];var e=t.split(O);return e[1]?C.declElem(e[0],e[1],{},{lazyInit:!0},!0):C.declBlock(t,{},{lazyInit:!0},!0)}function p(t,e,n){return t.uniqId||(t.uniqId=(t.id?e+"-id-"+t.id:a())+(n||a())),t}function _(t,e,n){var i=t.find(e);return n?i:i.add(t.filter(e))}function v(t){var e=a(t);return N[e]||(N[e]=g(t))}function y(t,e){var n=v(t);return n[e]||(n[e]={})}function g(t){var e=t.getAttribute(T);return e?JSON.parse(e):{}}function b(t,e){1===t.domElem.length?(t._delInitedMod(),delete x[t._uniqId]):t.domElem=t.domElem.not(e)}function E(t){t.each(function(){j[a(this)]=this.parentNode})}function M(t,e){t.add(t.parents()).each(function(t,n){var i=N[a(n)];i&&c.each(i,function(t){var n=x[t.uniqId];if(n){var i=e[n.__self._blockName];i&&n._dropElemCache(Object.keys(i))}})}),e={}}function k(t){return"string"==typeof t?t={elem:t}:d.isFunction(t)?t={elem:t.getName()}:d.isFunction(t.elem)&&(t.elem=t.elem.getName()),{elem:t.elem,mod:R(t.modName,t.modVal)}}function I(t){return u("string"==typeof t?u.parseHTML(t,null,!0):t)}var w,C,D={},x={},j={},N={},P={},B=e.entities,S="i-bem",A="."+S,T="data-bem",q=n.NAME_PATTERN,F=n.MOD_DELIM,O=n.ELEM_DELIM,R=n.buildModPostfix,V=n.buildClassName,L=Array.prototype.reverse,H=Array.prototype.slice,z=new o.EventManagerFactory(m),Q=new r.EventManagerFactory(m),W=s({__constructor:function(t,e,n){this.domElem=t,this._elemsCache={},this._elemCache={},this._findBackRefs=[],x[e.uniqId||a(this)]=this,this.__base(null,e,n)},_block:function(){},_elems:function(t){var e=k(t),n=this._elemsCache[e.elem];if(n&&e.mod in n)return n[e.mod];var i=(n||(this._elemsCache[e.elem]={}))[e.mod]=this.findMixedElems(t).concat(this.findChildElems(t));return i.forEach(function(t){t._findBackRefs.push(this)},this),i},_elem:function(t){var e=k(t),n=this._elemCache[e.elem];if(n&&e.mod in n)return n[e.mod];var i=(n||(this._elemCache[e.elem]={}))[e.mod]=this.findMixedElem(t)||this.findChildElem(t);return i&&i._findBackRefs.push(this),i},_dropElemCache:function(t){return arguments.length?((Array.isArray(t)?t:H.call(arguments)).forEach(function(t){var e=k(t);e.mod?(this._elemsCache[e.elem]&&delete this._elemsCache[e.elem][e.mod],this._elemCache[e.elem]&&delete this._elemCache[e.elem][e.mod]):(delete this._elemsCache[e.elem],delete this._elemCache[e.elem])},this),this):(this._elemsCache={},this._elemCache={},this)},findChildBlock:function(t){return this._findEntities("find",t,!0)},findChildBlocks:function(t){return this._findEntities("find",t)},findParentBlock:function(t){return this._findEntities("parents",t,!0)},findParentBlocks:function(t){return this._findEntities("parents",t)},findMixedBlock:function(t){return this._findEntities("filter",t,!0)},findMixedBlocks:function(t){return this._findEntities("filter",t)},findChildElem:function(t,e){return e?this._filterFindElemResults(this._findEntities("find",t)).get(0):this._findEntities("find",t,!0)},findChildElems:function(t,e){var n=this._findEntities("find",t);return e?this._filterFindElemResults(n):n},findParentElem:function(t,e){return e?this._filterFindElemResults(this._findEntities("parents",t))[0]:this._findEntities("parents",t,!0)},findParentElems:function(t,e){var n=this._findEntities("parents",t);return e?this._filterFindElemResults(n):n},findMixedElem:function(t){return this._findEntities("filter",t,!0)},findMixedElems:function(t){return this._findEntities("filter",t)},_filterFindElemResults:function(t){var e=this._block();return t.filter(function(t){return t._block()===e})},_findEntities:function(t,e,n){var o=d.isFunction(e)?e.getEntityName():"object"==typeof e?e.block?e.block.getEntityName():"string"==typeof e.elem?this.__self._blockName+O+e.elem:e.elem.getEntityName():this.__self._blockName+O+e,r="."+("object"==typeof e?V(o,e.modName,"undefined"==typeof e.modVal||e.modVal):V(o))+(n?":first":""),s=this.domElem[t](r);if(n)return s[0]?h(o,s.eq(0),w,!0)._setInitedMod():null;var a=[],c={};return s.each(function(t,e){var n=h(o,u(e),w,!0)._setInitedMod();c[n._uniqId]||(c[n._uniqId]=!0,a.push(n))}),new i(a)},_domEvents:function(t){return z.getEventManager(this,t,this.domElem)},_events:function(t){return Q.getEventManager(this,t,this.domElem)},_emit:function(t,e){return("object"==typeof t&&"js"===t.modName||this.hasMod("js","inited"))&&r.emit(this,t,e),this},_extractModVal:function(t){var e,n=this.domElem[0];return n&&(e=n.className.match(this.__self._buildModValRE(t))),e?e[2]||!0:""},_onSetMod:function(t,e,n){var i=this.__self,o=i.getName();if(this._findBackRefs.forEach(function(i){""===n||i._dropElemCache({elem:o,modName:t,modVal:n}),i._dropElemCache(""===e?o:{elem:o,modName:t,modVal:e})}),this.__base.apply(this,arguments),"js"!==t||""!==e){var r=i._buildModClassNamePrefix(t),s=i._buildModValRE(t),a=""===e;this.domElem.each(function(){var t=this.className,i=r;e!==!0&&(i+=F+e),(n===!0?s.test(t):(" "+t).indexOf(" "+r+F)>-1)?this.className=t.replace(s,a?"":"$1"+i):a||u(this).addClass(i)})}},_afterSetMod:function(t,e,n){var i={modName:t,modVal:e,oldModVal:n};this._emit({modName:t,modVal:"*"},i)._emit({modName:t,modVal:e},i)},containsEntity:function(t){return f.contains(this.domElem,t.domElem)}},{create:function(){throw Error("bemDom entities can not be created otherwise than from DOM")},_processInit:function(t){if(this.onInit&&this._inited==t){this.__base(t),this.onInit();var e=this.getName(),n=this.onInit;this.init=function(){this.getName()===e&&n.apply(this,arguments)}}},_domEvents:function(t){return z.getEventManager(this,t,C.scope)},_events:function(t){return Q.getEventManager(this,t,C.scope)},_buildModClassNamePrefix:function(t){return this.getEntityName()+F+t},_buildModValRE:function(t){return new RegExp("(\\s|^)"+this._buildModClassNamePrefix(t)+"(?:"+F+"("+q+"))?(?=\\s|$)")},_buildClassName:function(t,e){return V(this.getEntityName(),t,e)},_buildSelector:function(t,e){return"."+this._buildClassName(t,e)}}),$=s([e.Block,W],{_block:function(){return this}}),J=s([e.Elem,W],{_block:function(){return this._blockInstance||(this._blockInstance=this.findParentBlock(m(this.__self._blockName)))}});u.fn.bem=function(t,e){var n=h(t.getEntityName(),this,e,!0);return n?n._setInitedMod():null},u(function(){C={scope:u("body"),doc:u(document),win:u(window),Block:$,Elem:J,isEntity:function(t){return t instanceof $||t instanceof J},declBlock:function(t,n,i,o){return n&&("object"!=typeof n||Array.isArray(n))||(o=i,i=n,n="string"==typeof t?B[t]||$:t),e.declBlock(t,n,i,o)},declElem:function(t,n,i,o,r){return i&&("object"!=typeof i||Array.isArray(i))||(r=o,o=i,i=B[t+O+n]||J),e.declElem(t,n,i,o,r)},declMixin:e.declMixin,init:function(t){t="string"==typeof t?u(t):t||C.scope;var n=t===C.scope?{}:w,i=a();return _(t,A).each(function(){l(u(this),i,n)}),e._runInitFns(),n&&M(t,n),t},_destruct:function(t,e,n){var i,o=[];E(i=e?t.children():t),L.call(_(i,A)).each(function(t,e){var n=v(e),i=a(e);P[i]=!0,o.push(i),c.each(n,function(t){if(t.uniqId){var n=x[t.uniqId];n?b(n,e):delete D[t.uniqId]}}),delete N[a(e)]}),n&&(e?t.empty():t.remove()),j={},o.forEach(function(t){delete P[t]})},destruct:function(t,e){this._destruct(t,e,!0)},detach:function(t,e){this._destruct(t,e)},update:function(t,e){return this.destruct(t,!0),this.init(t.html(e))},replace:function(t,e){var n=t.prev(),i=t.parent();return e=I(e),this.destruct(t),this.init(n.length?e.insertAfter(n):e.prependTo(i))},append:function(t,e){return this.init(I(e).appendTo(t))},prepend:function(t,e){return this.init(I(e).prependTo(t))},before:function(t,e){return this.init(I(e).insertBefore(t))},after:function(t,e){return this.init(I(e).insertAfter(t))}},t(C)})}),function(){var t=modules.define;modules.define=function(e,n,i){t.apply(modules,arguments),"i-bem-dom__init"!==e&&arguments.length>2&&~n.indexOf("i-bem-dom")&&modules.define("i-bem-dom__init",[e],function(t,e,n){t(n)})}}(),modules.define("i-bem-dom__init",["i-bem-dom"],function(t,e){t(function(t){return e.init(t)})}),modules.define("i-bem-dom__events",["i-bem__internal","i-bem-dom__collection","inherit","identify","objects","jquery","functions"],function(t,e,n,i,o,r,s,a){var c,d=window,u=document,f=(o(d),o(u),{}),l=i({__constructor:function(t,e,n){this._params=t,this._fnWrapper=e,this._eventBuilder=n,this._storage={}},on:function(t,e,n,i,r){var s=this._params;t=this._eventBuilder(t,s),a.isFunction(e)&&(r=i,i=n,n=e,e=c);var d=this._storage[t]||(this._storage[t]={}),u=o(n,i);if(!d[u]){var f=s.bindDomElem,l=r?"one":"on",h=s.bindSelector,m=d[u]=this._fnWrapper(n,i,u);f[l](t,h,e,m),h&&f.is(h)&&f[l](t,e,m)}return this},once:function(t,e,n,i){return a.isFunction(e)&&(i=n,n=e,e=c),this.on(t,e,n,i,!0)},un:function(t,e,n){var i=arguments.length;if(i){var s=this._params;if(t=this._eventBuilder(t,s),1===i)this._unbindByEvent(this._storage[t],t);else{var a,c=o(e,n),d=this._storage[t],u=s.bindDomElem,f=s.bindSelector;(a=d&&d[c])&&delete d[c];var l=a||e;u.off(t,s.bindSelector,l),f&&u.is(f)&&u.off(t,l)}}else r.each(this._storage,this._unbindByEvent,this);return this},_unbindByEvent:function(t,e){var n=this._params,i=n.bindDomElem,o=n.bindSelector,s=o&&i.is(o);t&&r.each(t,function(t){i.off(e,o,t),s&&i.off(e,t)}),this._storage[e]=null}}),h=function(t){return function(){var e=arguments;return this._eventManagers.forEach(function(n){n[t].apply(n,e)}),this}},m=i({__constructor:function(t){this._eventManagers=t},on:h("on"),once:h("once"),un:h("un")}),p=i({__constructor:function(t){this._storageSuffix=o(),this._getEntityCls=t,this._eventManagerCls=l},getEventManager:function(t,e,i){if(e instanceof n)return new m(e.map(function(e){return this.getEventManager(t,e,i)},this));var r,s=o(t),a=f[s],c=this._storageSuffix,d="function"!=typeof t,u="";d?r=t.__self:(r=t,u=t._buildSelector());var l=this._buildEventManagerParams(e,i,u,r),h=l.key+c;return a||(a=f[s]={},d&&t._events().on({modName:"js",modVal:""},function(){l.bindToArbitraryDomElem&&a[h]&&a[h].un(),delete a[s]})),a[h]||(a[h]=this._createEventManager(t,l,d))},_buildEventManagerParams:function(t,n,i,r){var a={bindEntityCls:null,bindDomElem:n,bindToArbitraryDomElem:!1,bindSelector:i,ctxSelector:i,key:""};if(t){var c=typeof t;if(t.jquery)a.bindDomElem=t,a.key=o.apply(null,t.get()),a.bindToArbitraryDomElem=!0;else if(t===d||t===u||"object"===c&&1===t.nodeType)a.bindDomElem=s(t),a.key=o(t),a.bindToArbitraryDomElem=!0;else if("object"===c&&t.__self)a.bindDomElem=t.domElem,a.key=t._uniqId,a.bindEntityCls=t.__self;else if("string"===c||"object"===c||"function"===c){var f,l,h,m;"string"===c?(f=r._blockName,l=t):"object"===c?(f=t.block?t.block.getName():r._blockName,l="function"==typeof t.elem?t.elem.getName():t.elem,h=t.modName,m=t.modVal):t.getName()===t.getEntityName()?f=t.getName():(f=r._blockName,l=t.getName());var p=e.buildClassName(f,l);a.bindEntityCls=this._getEntityCls(p),a.bindSelector="."+(a.key=p+e.buildModPostfix(h,m))}}else a.bindEntityCls=r;return a},_createEventManager:function(t,e,n){throw new Error("not implemented")}});t({EventManagerFactory:p})}),modules.define("i-bem",["i-bem__internal","inherit","identify","next-tick","objects","functions"],function(t,e,n,i,o,r,s){function a(t,e,n){return"__"+t+"__mod"+(e?"_"+e:"")+(n?"_"+n:"")}function c(t,e,n,i){return n||i?function(o,r,s){var a,c;if(n&&(a=n.apply(this,arguments)===!1),(!i||i(t,r,s))&&(c=e.apply(this,arguments)===!1),a||c)return!1}:e}function d(t,e,n){if(s.isFunction(e))n[a(t,"*","*")]=e;else{var i,o,r;for(i in e)if(r=e[i],s.isFunction(r))n[a(t,i,"*")]=r;else{var d=a(t,i,"*");for(o in r){var u=r[o],f=o[0];"!"===f||"~"===f||"*"===o?("*"===o||(o=o.substr(1)),n[d]=c(o,u,n[d],y[f])):n[a(t,i,o)]=u}}}}function u(t,e){return e?Array.isArray(e)?function(n){for(var i=0,o=e.length;i<o;)if(f(n,t,e[i++]))return!0;return!1}:function(n){return f(n,t,e)}:function(e){return f(e,t,!0)}}function f(t,e,n){var i=t._processingMods[e];return"*"===n?t.hasMod(e)||null!=i:t.hasMod(e,n)||i===n}function l(t){t.beforeSetMod&&(d("before",t.beforeSetMod,t),delete t.beforeSetMod),t.onSetMod&&(d("after",t.onSetMod,t),delete t.onSetMod)}function h(t,e,i,o,r){i||(i=v[e]||t),Array.isArray(i)||(i=[i]),i[0].__bemEntity||(i=i.slice(),i.unshift(v[e]||t)),o&&l(o);var s;return e===i[0].getEntityName()?(s=n.self(i,o,r))._processInit(!0):s=v[e]=n(i,o,r),s}var m,p=e.ELEM_DELIM,_=[],v={},y={"!":function(t,e,n){return e!==t},"~":function(t,e,n){return n===t}},g=n({__constructor:function(t,e,n){this._modCache=t||{},this._processingMods={},this.params=r.extend(this._getDefaultParams(),e),this._uniqId=this.params.uniqId||i(this),n!==!1?this._setInitedMod():_.push(this._setInitedMod,this)},_setInitedMod:function(){return this.setMod("js","inited")},_delInitedMod:function(){this.delMod("js")},hasMod:function(t,e){var n=typeof e;"undefined"===n||"boolean"===n||(e=e.toString());var i=this.getMod(t)===(e||"");return 1===arguments.length?!i:i},getMod:function(t){var e=this._modCache;return t in e?e[t]||"":e[t]=this._extractModVal(t)},setMod:function(t,e){var n=typeof e;if("undefined"===n?e=!0:"boolean"===n?e===!1&&(e=""):e=e.toString(),null!=this._processingMods[t])return this;var i=this.getMod(t);if(i===e)return this;this._processingMods[t]=i;for(var o,r,s,a=!0,c=[t,e,i],d=[["*","*"],[t,"*"],[t,e]],u=["before","after"],f=0;o=u[f++];){for(r=0;s=d[r++];)if(this._callModFn(o,s[0],s[1],c)===!1){a=!1;break}if(!a)break;"before"===o&&(this._modCache[t]=e,this._onSetMod(t,e,i))}return this._processingMods[t]=null,a&&this._afterSetMod(t,e,i),this},_onSetMod:function(t,e,n){},_afterSetMod:function(t,e,n){},toggleMod:function(t,e,n,i){"undefined"==typeof e&&(e=!0),"undefined"==typeof n?n="":"boolean"==typeof n&&(i=n,n="");var o=this.getMod(t);return(o===e||o===n)&&this.setMod(t,"boolean"==typeof i?i?e:n:this.hasMod(t,e)?n:e),this},delMod:function(t){return this.setMod(t,"")},_callModFn:function(t,e,n,i){var o=a(t,e,n);return this[o]?this[o].apply(this,i):m},_extractModVal:function(t){return""},_getDefaultParams:function(){return{}},_nextTick:function(t){var e=this;return o(function(){e.hasMod("js","inited")&&t.call(e)}),this}},{create:function(t,e){return new this(t,e)},declMod:function(t,e,i){e&&l(e);var o=u(t.modName,t.modVal),a=this.prototype;return r.each(e,function(t,n){s.isFunction(t)&&(e[n]=function(){var e;if(o(this))e=t;else{var i=a[n];i&&i!==t&&(e=this.__base)}return e?e.apply(this,arguments):m})}),n.self(this,e,i)},__bemEntity:!0,_name:null,_processInit:function(t){this._inited=!0},getName:function(){return this._name},getEntityName:function(){return this._name}}),b=g,E=n(g,{_block:function(){return this._blockInstance}},{create:function(t,e,n){var i=new this(e,n);return i._blockInstance=t,i},getEntityName:function(){return this._blockName+p+this._name}});t({Block:b,Elem:E,entities:v,declBlock:function(t,e,n,i){"object"!=typeof e||Array.isArray(e)||(i=n,n=e,e=m);var o=b;"string"!=typeof t&&(o=t,t=t.getEntityName());var r=h(o,t,e,n,i);return r._name=r._blockName=t,r},declElem:function(t,e,n,i,o){var r,s=E;"string"!=typeof t?(o=i,i=n,n=e,e=t._name,s=t,t=s._blockName,r=s.getEntityName()):r=t+p+e,"object"!=typeof n||Array.isArray(n)||(o=i,i=n,n=m);var a=h(s,r,n,i,o);return a._blockName=t,a._name=e,a},declMixin:function(t,e){return l(t||(t={})),n(t,e)},_runInitFns:function(){if(_.length){var t,e=_,n=0;for(_=[];t=e[n];)t.call(e[n+1]),n+=2}}})}),modules.define("jquery",["loader_type_js","jquery__config"],function(t,e,n){function i(e){t(e?jQuery:jQuery.noConflict(!0))}"undefined"!=typeof jQuery?i(!0):e(n.url,i)}),modules.define("i-cart",["events","identify","jquery"],function(t,e,n,i){function o(t,e){var o=n();return i.cart&&(a[o]=i.cart("put",t).then(function(e){return{id:t.shopProductId,count:e.count,cost:e.cartInfo.cost,raw:e}})),c.emit("add",{cid:o,id:t.shopProductId,rid:t.rid}),e?o:a[o]}function r(t,e){var o=n();return i.cart&&(a[o]=i.cart("hidePosition",{cartPositionId:t.pid}).then(function(e){return{id:t.shopProductId,pid:t.pid,count:e.count,cost:e.cartInfo.cost,raw:e}})),c.emit("remove",{cid:o,id:t.shopProductId,pid:t.pid}),e?o:a[o]}function s(t){return t&&a[t]?a[t]:null}var a={},c=new e.Emitter;t({on:c.on.bind(c),un:c.un.bind(c),getPromiseByID:s,addToCart:o,removeFromCart:r})}),modules.define("i-product",["identify","jquery"],function(t,e,n){function i(t,i,o){if(t){var s=e();return a[s]=n.ajax({dataType:"json",url:t,data:{productIDs:i}}).then(function(t){return(t||[]).forEach(function(t){r(t),t.rid=s}),t}),o?s:a[s]}return null}function o(t){return t&&a[t]?a[t]:null}function r(t){t.id&&(c[t.id]=n.extend(!0,{},t))}function s(t){return c[t]?n.extend(!0,{},c[t]):null}var a={},c={};t({addProductInformation:r,getProductInformation:s,getPromiseByID:o,getRelatedForProductID:i})}),modules.define("i-support",function(t){var e,n=window,i={arrayBuffer:"ArrayBuffer"in n,blob:"FileReader"in n&&"Blob"in n&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in n,transition:function(){var t=function(){var t,n=document.createElement("support"),i={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(t in i)if(n.style[t]!==e)return i[t]}();return t&&{end:t}}()};t(i)}),modules.define("i-modal",["i-bem-dom","BH","i-support"],function(t,e,n,i){var o;t({sidebar:function(t){function n(t){}e.scope.addClass("page_fixed page_blur");var o=this.getModal("sidebar");return o.setContent(t).setMod("visible"),o.domElem[0].offsetHeight,o.setMod("visible","in"),i.transition?o._elem("backdrop").domElem.on(i.transition.end,n):n("none"),this},show:function(t){e.scope.addClass("page_fixed page_blur");var n=this.getModal();return n.setContent(t).setMod("visible"),n.domElem[0].offsetHeight,n.setMod("visible","in"),this},hide:function(){if(o){var t=this,n=this.getModal().setMod("visible");n.domElem[0].offsetHeight,window.setTimeout(function(){t.getModal().setMod("visible",!1),e.scope.removeClass("page_fixed page_blur"),e.destruct(n.domElem)},400)}return this},setInstance:function(t){o=t},getInstance:function(){return o},getModal:function(t){return o||e.prepend(e.scope,n.apply({block:"modal",js:!0,mods:{autoclosable:!0,theme:"blur",type:t||!1}})),o},scrollToTop:function(){o&&o._elem("sidebar").domElem.animate({scrollTop:0},400)},setState:function(t){o&&o.setMod("state",t)}})}),modules.define("cart-widget-related-product",["i-bem-dom","BH","jquery","i-cart"],function(t,e,n,i,o){var r=e.declBlock(this.name,{onSetMod:{js:{inited:function(){this.orderId=null,this.setMod("state","success"),this._onAddToCart(this.params.cid),o.on("add",function(t,e){this._onAddToCart(e.cid,e.id)},this),o.on("remove",function(t,e){this._onRemoveFromCart(e.cid,e.id)},this),this._domEvents("action").on("click",this._onClick)}},state:{waiting:function(){this.isDisabled=!0,this._elem("action").domElem.text("Ожидание...")},success:function(){this.isDisabled=!1,this._elem("action").domElem.text(this.getMod("checked")?"Добавлено":"Добавить")},error:function(){this.isDisabled=!0,this._elem("action").domElem.text("Ошибка")}}},_onAddToCart:function(t,e){if(t){var n=this,i=o.getPromiseByID(t);e==n.params.pid?(this.setMod("state","waiting"),i.then(function(t){t.id&&t.id==n.params.pid&&n.setMod("checked"),n.setMod("state","success")},function(){n.setMod("state","error")})):(this.isDisabled=!0,i.then(function(){n.isDisabled=!1}))}},_onRemoveFromCart:function(t,e){if(t){var n=this,i=o.getPromiseByID(t);e==n.params.pid?(this.setMod("state","waiting"),i.then(function(t){t.id&&t.id==n.params.pid&&n.delMod("checked"),n.setMod("state","success")},function(){n.setMod("state","error")})):(this.isDisabled=!0,i.then(function(){n.isDisabled=!1}))}},_onClick:function(){if(!this.isDisabled){var t=this,e=this.getMod("checked");e&&this.orderId?o.removeFromCart({shopProductId:+this.params.pid,pid:this.orderId}).then(function(){t.orderId=null}):(this.setMod("checked"),o.addToCart({shopProductId:+this.params.pid,rid:this.params.rid}).then(function(e){e.raw.cartInfo&&i.isArray(e.raw.cartInfo.newPositions)&&(t.orderId=e.raw.cartInfo.newPositions[0].id),yii&&yii.analytics&&yii.analytics.triggerEvent("RELATED_ADDTOCART")}))}}});t(r)}),modules.define("cart-widget",["i-bem-dom","BH","i-cart","i-modal"],function(t,e,n,i,o){t(e.declBlock(this.name,{onSetMod:{js:{inited:function(){this.process(this.params.cid),i.on("add",function(t,e){this.process(e.cid)},this),i.on("remove",function(t,e){this.process(e.cid)},this)}}},process:function(t){if(t){var e=i.getPromiseByID(t);o.setState("locked"),e.then(function(){o.setState(!1)},function(){o.setState(!1)})}}}))}),modules.define("add-to-cart",["i-bem-dom","i-modal","i-cart","i-product","BH"],function(t,e,n,i,o,r){t(e.declBlock(this.name,{onSetMod:{js:{inited:function(){var t=this;if(this.productIDs=[],this.rid=null,this.count=0,this.cost=0,this.params.productID?this.productIDs.push(this.params.productID):(this.params.children||[]).forEach(function(e){e.productID&&t.productIDs.push(e.productID)}),(this.params.children||[]).length)this.params.children.forEach(function(e){if(e.productID){var n=e.count||1,i=Array.isArray(e.price)?e.price[0]:e.price;t.count+=n,t.cost+=n*i}});else{var e=this.params.count||1,n=Array.isArray(this.params.price)?this.params.price[0]:this.params.price;this.count=e,this.cost=e*n}this.productIDs.length&&(this._domEvents().on("mouseenter",this._onMouseEnter),this._domEvents().on("click",this._onClick))}}},_onClick:function(t){if(t.preventDefault(),t.stopPropagation(),this.rid){var e={};(this.params.children||[]).length?this.params.kitID?e={kitId:+this.params.kitID}:this.params.productID&&(e={shopProductId:this.params.productID,parameterValues:(this.params.children||[]).map(function(t){return{id:+t.productID,count:+(t.count||1)}})}):this.params.productID&&(e={shopProductId:+this.params.productID},o.addProductInformation({id:this.params.productID,image:this.params.image,price:this.params.price,title:this.params.title,type:this.params.type})),this.cid=i.addToCart(e,!0),n.sidebar(r.apply({block:"cart-widget",mods:{state:"waiting"},js:{cid:this.cid,rid:this.rid},cid:this.cid,rid:this.rid,count:this.count,cost:this.cost,position:[this.params]}))}},_onMouseEnter:function(t){this.rid||(this.rid=o.getRelatedForProductID(this.params.relatedUrl,this.productIDs,!0))}}))}),modules.define("modal",["i-bem-dom","i-modal"],function(t,e,n){var i=e.declBlock(this.name,{onSetMod:{js:{inited:function(){this.isLocked=!1,n.setInstance(this)},"":function(){n.setInstance(null)}},state:function(t,e){this.isLocked="locked"==e}},setContent:function(t){return e.update(this._elem("content").domElem,t),this}},{lazyInit:!1,onInit:function(){this._domEvents("close").on("click",function(){!this.isLocked&&n.hide()}),this._domEvents("backdrop").on("click",function(){!this.isLocked&&this.hasMod("autoclosable")&&n.hide()})}});t(i)}),modules.define("modal",function(t,e){t(e.declMod({modName:"type",modVal:"sidebar"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments)},"":function(){this.__base.apply(this,arguments)}}}}))}),modules.require(["i-bem-dom__init","jquery","next-tick"],function(t,e,n){e(function(){n(t)})}),modules.define("cart-widget__status-bar",["i-bem-dom","i-cart"],function(t,e,n){t(e.declElem("cart-widget","status-bar",{onSetMod:{js:{inited:function(){this._onInit(this.params.cid),n.on("add",function(t,e){this._process(e.cid)},this),n.on("remove",function(t,e){this._process(e.cid)},this)}}},_onInit:function(t){if(t){var e=this,i=n.getPromiseByID(t);this.setMod("state","waiting"),i.then(function(t){e.domElem.attr("data-content",t.count),e.setMod("state","success")},function(){e.setMod("state","error")})}},_process:function(t){if(t){var e=this,i=n.getPromiseByID(t);e.domElem.attr("data-content",""),i.then(function(t){e.domElem.attr("data-content",t.count)})}}}))}),modules.define("cart-widget__count",["i-bem-dom","i-cart"],function(t,e,n){t(e.declElem("cart-widget","count",{onSetMod:{js:{inited:function(){this.process(this.params.cid),n.on("add",function(t,e){this.process(e.cid)},this),n.on("remove",function(t,e){this.process(e.cid)},this)}}},process:function(t){if(t){var e=this,i=n.getPromiseByID(t);this.setMod("state","waiting"),i.then(function(t){e.domElem.text(e._format(t.count)),e.setMod("state","success")},function(){e.setMod("state","error")})}},_format:function(t){var e=["товар","товара","товаров"],n=e[t%10==1&&t%100!=11?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2];return"Итого "+t+" "+n+" на сумму"}}))}),modules.define("cart-widget__cost",["i-bem-dom","i-cart"],function(t,e,n){t(e.declElem("cart-widget","cost",{onSetMod:{js:{inited:function(){this.process(this.params.cid),n.on("add",function(t,e){this.process(e.cid)},this),n.on("remove",function(t,e){this.process(e.cid)},this)}}},process:function(t){if(t){var e=this,i=n.getPromiseByID(t);this.setMod("state","waiting"),i.then(function(t){var n=(t.cost+"").replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1 ");e.domElem.text(n),e.setMod("state","success")},function(){e.setMod("state","error")})}}}))}),modules.define("cart-widget__checkout",["i-bem-dom","i-cart"],function(t,e,n){t(e.declElem("cart-widget","checkout",{onSetMod:{js:{inited:function(){this.isDisabled=!1,this.process(this.params.cid),n.on("add",function(t,e){this.process(e.cid)},this),n.on("remove",function(t,e){this.process(e.cid)},this),this._domEvents().on("click",this._onClick)}},state:function(t,e){this.domElem.attr("disabled","waiting"==e),this.isDisabled="waiting"==e}},process:function(t){if(t){var e=this,i=n.getPromiseByID(t);this.setMod("state","waiting"),i.then(function(){e.setMod("state","success")},function(){e.setMod("state","error")})}},_onClick:function(t){this.isDisabled&&(t.preventDefault(),t.stopPropagation())}}))}),modules.define("cart-widget__related-products",["i-bem-dom","BH","i-product"],function(t,e,n,i){t(e.declElem("cart-widget","related-products",{onSetMod:{js:{inited:function(){this.process(this.params.rid)}}},process:function(t){if(t){var o=this,r=i.getPromiseByID(t);this.setMod("state","waiting"),r.then(function(t){var i=t.reduce(function(t,e){return e.cid=o.params.cid,t+n.apply({block:"cart-widget-related-product",mix:{block:"cart-widget",elem:"related-product"},data:e})},"");e.update(o._block()._elem({elem:"row",modName:"related-products",modVal:!0}).domElem,i),o.setMod("state","success")},function(){o.setMod("state","error")})}}}))}),function(t){function e(t){var e=d(t);if(p)for(var n,i=0;n=y[i++];)t.hasOwnProperty(n)&&e.push(n);return e}function n(t,n,i){for(var o,s,a=e(i),c=0,d=a.length;c<d;)"__self"!==(o=a[c++])&&(s=i[o],h(s)&&(!r||s.toString().indexOf(".__base")>-1)?n[o]=function(e,i){var o=t[e]?t[e]:"__constructor"===e?n.__self.__parent:m;return function(){var t=this.__base;this.__base=o;var e=i.apply(this,arguments);return this.__base=t,e}}(o,s):n[o]=s)}function i(t,e){for(var n,i=1;n=t[i++];)e?h(n)?o.self(e,n.prototype,n):o.self(e,n):e=h(n)?o(t[0],n.prototype,n):o(t[0],n);return e||t[0]}function o(){var t=arguments,e=l(t[0]),o=e||h(t[0]),r=o?e?i(t[0]):t[0]:s,a=t[o?1:0]||{},d=t[o?2:1],f=a.__constructor||o&&r.prototype.__constructor?function(){return this.__constructor.apply(this,arguments)}:o?function(){return r.apply(this,arguments)}:function(){};if(!o)return f.prototype=a,f.prototype.__self=f.prototype.constructor=f,u(f,d);u(f,r),f.__parent=r;var m=r.prototype,p=f.prototype=c(m);return p.__self=p.constructor=f,a&&n(m,p,a),d&&n(r,f,d),f}var r=function(){"_"}.toString().indexOf("_")>-1,s=function(){},a=Object.prototype.hasOwnProperty,c=Object.create||function(t){var e=function(){};return e.prototype=t,new e},d=Object.keys||function(t){var e=[];for(var n in t)a.call(t,n)&&e.push(n);return e},u=function(t,e){for(var n in e)a.call(e,n)&&(t[n]=e[n]);return t},f=Object.prototype.toString,l=Array.isArray||function(t){return"[object Array]"===f.call(t)},h=function(t){return"[object Function]"===f.call(t)},m=function(){},p=!0,_={toString:""};for(var v in _)_.hasOwnProperty(v)&&(p=!1);var y=p?["toString","valueOf"]:null;o.self=function(){var t=arguments,e=l(t[0]),o=e?i(t[0],t[0][0]):t[0],r=t[1],s=t[2],a=o.prototype;return r&&n(a,a,r),s&&n(o,o,s),o};var g=!0;"object"==typeof exports&&(module.exports=o,g=!1),"object"==typeof modules&&(modules.define("inherit",function(t){t(o)}),g=!1),"function"==typeof define&&(define(function(t,e,n){n.exports=o}),g=!1),g&&(t.inherit=o)}(this),modules.define("loader_type_js",function(t){var e={},n={},i=document.getElementsByTagName("head")[0],o=function(t,n){var i,o=e[t],r=0;for(delete e[t];i=o[r++];)i[n]&&i[n]()},r=function(t){n[t]=!0,o(t,"success")},s=function(t){o(t,"error")};t(function(t,o,a){if(n[t])return void(o&&o());if(e[t])return void e[t].push({success:o,error:a});e[t]=[{success:o,error:a}];var c=document.createElement("script");c.type="text/javascript",c.charset="utf-8",c.src=("file:"!==location.protocol||t.indexOf("//")?"":"http:")+t,"onload"in c?(c.onload=function(){c.onload=c.onerror=null,r(t)},c.onerror=function(){c.onload=c.onerror=null,s(t)}):c.onreadystatechange=function(){var e=this.readyState;"loaded"!==e&&"complete"!==e||(c.onreadystatechange=null,r(t))},i.insertBefore(c,i.lastChild)})}),modules.define("jquery__config",function(t){t({url:"https://yastatic.net/jquery/3.1.0/jquery.min.js"})}),modules.define("jquery__config",["ua","objects"],function(t,e,n,i){t(e.msie&&parseInt(e.version,10)<9?n.extend(i,{url:"https://yastatic.net/jquery/1.12.3/jquery.min.js"}):i)}),modules.define("ua",function(t){var e=navigator.userAgent.toLowerCase(),n=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[],i={browser:n[1]||"",version:n[2]||"0"},o={};i.browser&&(o[i.browser]=!0,o.version=i.version),o.chrome?o.webkit=!0:o.webkit&&(o.safari=!0),t(o)}),modules.define("functions",function(t){var e=Object.prototype.toString;t({isFunction:function(t){return"[object Function]"===e.call(t)},noop:function(){}})}),modules.define("dom",["jquery"],function(t,e){t({contains:function(t,e){var n=!1;return e.each(function(){var e=this;do if(~t.index(e))return!(n=!0);while(e=e.parentNode);return n}),n},getFocused:function(){try{return e(document.activeElement)}catch(t){}},containsFocus:function(t){return this.contains(t,this.getFocused())},isFocusable:function(t){var e=t[0];if(!e)return!1;if(e.hasAttribute("tabindex"))return!0;switch(e.tagName.toLowerCase()){case"iframe":return!0;case"input":case"button":case"textarea":case"select":return!e.disabled;case"a":return!!e.href}return!1},isEditable:function(t){var e=t[0];if(!e)return!1;switch(e.tagName.toLowerCase()){case"input":var n=e.type;return!("text"!==n&&"password"!==n||e.disabled||e.readOnly);case"textarea":return!e.disabled&&!e.readOnly;default:return"true"===e.contentEditable}}})}),modules.define("i-bem__internal",function(t){function e(t){var e=typeof t;return"string"===e||"number"===e||"boolean"===e}function n(t,e){var n="";return null!=e&&e!==!1&&(n+=s+t,e!==!0&&(n+=s+e)),n}function i(t,e,i){return t+n(e,i)}function o(t,e,o,s){return i(t,r,r)+a+e+n(o,s)}var r,s="_",a="__",c="[a-zA-Z0-9-]+";t({NAME_PATTERN:c,MOD_DELIM:s,ELEM_DELIM:a,buildModPostfix:n,buildClassName:function(t,n,s,a){return e(s)?e(a)||(a=s,s=n,n=r):"undefined"!=typeof s?s=r:n&&"string"!=typeof n&&(n=r),n||s?n?o(t,n,s,a):i(t,s,a):t},buildClassNames:function(t,e,n){
e&&"string"!=typeof e&&(n=e,e=r);var s=e?o(t,e,r,r):i(t,r,r);if(n)for(var a in n)n.hasOwnProperty(a)&&n[a]&&(s+=" "+(e?o(t,e,a,n[a]):i(t,a,n[a])));return s}})}),modules.define("identify",function(t){var e=0,n="__"+ +new Date,i=function(){return"uniq"+ ++e},o=function(t){if("object"==typeof t&&null!==t||"function"==typeof t){var e="uniqueID"in t?"uniqueID":n;return e in t?t[e]:t[e]=i()}return""};t(function(t){if(arguments.length){if(1===arguments.length)return o(t);for(var e=[],n=0,r=arguments.length;n<r;n++)e.push(o(arguments[n]));return e.sort().join("")}return i()})}),modules.define("next-tick",function(t){var e=this.global,n=[],i=function(t){return 1===n.push(t)},o=function(){var t=n,e=0,i=n.length;for(n=[];e<i;)t[e++]()};if("object"==typeof process&&process.nextTick)return t(function(t){i(t)&&process.nextTick(o)});if(e.setImmediate)return t(function(t){i(t)&&e.setImmediate(o)});if(e.postMessage){var r=!0;if(e.attachEvent){var s=function(){r=!1};e.attachEvent("onmessage",s),e.postMessage("__checkAsync","*"),e.detachEvent("onmessage",s)}if(r){var a="__nextTick"+ +new Date,c=function(t){t.data===a&&(t.stopPropagation&&t.stopPropagation(),o())};return e.addEventListener?e.addEventListener("message",c,!0):e.attachEvent("onmessage",c),t(function(t){i(t)&&e.postMessage(a,"*")})}}var d=e.document;if("onreadystatechange"in d.createElement("script")){var u=d.getElementsByTagName("head")[0],f=function(){var t=d.createElement("script");t.onreadystatechange=function(){t.parentNode.removeChild(t),t=t.onreadystatechange=null,o()},u.appendChild(t)};return t(function(t){i(t)&&f()})}t(function(t){i(t)&&e.setTimeout(o,0)})}),modules.define("i-bem-dom__events_type_dom",["i-bem-dom__events","inherit","jquery"],function(t,e,n,i){var o=function(t){return t},r=n(e.EventManagerFactory,{_createEventManager:function(t,e,n){function r(o){return function(r){var s;if(n)s=t;else{var a=i(r.target).closest(e.ctxSelector);a.length&&(s=a.bem(t))}s&&(e.bindEntityCls&&(r.bemTarget=i(this).bem(e.bindEntityCls)),o.call(s,r))}}return new this._eventManagerCls(e,r,o)}});t({EventManagerFactory:r})}),modules.define("i-bem-dom__events_type_bem",["i-bem-dom__events","i-bem__internal","inherit","functions","jquery","identify","events"],function(t,e,n,i,o,r,s,a){var c="__bem__",d="modchange",u=r.event.special,f={},l=function(t){return{setup:function(){f[t]||(f[t]=!0)},teardown:o.noop}},h=function(t,e){var i=c+e.bindEntityCls.getEntityName()+("object"==typeof t?t instanceof a.Event?t.type:n.buildModPostfix(t.modName,t.modVal):t);return u[i]||(u[i]=l(i)),i},m=i(e.EventManagerFactory,{_createEventManager:function(t,e,n){function i(i,o,s){return function(a,c,d,u){if(!d.fns[s]){var f,l;n?(f=t,l=f.domElem):(l=r(a.target).closest(e.ctxSelector),l.length&&(f=l.bem(t))),!f||d.propagationStoppedDomNode&&r.contains(l[0],d.propagationStoppedDomNode)||(u.data=a.data,u.bemTarget=u.target,d.fns[s]=!0,i.call(o||f,u,c),u.isPropagationStopped()&&(a.stopPropagation(),d.propagationStoppedDomNode=l[0]))}}}return new this._eventManagerCls(e,i,h)}});t({emit:function(t,e,n){var i;"string"==typeof e?i=new a.Event(e,t):e.modName?i=new a.Event(d,t):e.target||(e.target=t,i=e);var o=h(e,{bindEntityCls:t.__self});f[o]&&t.domElem.trigger(o,[n,{fns:{},propagationStoppedDomNode:null},i])},EventManagerFactory:m})}),modules.define("i-bem-dom__collection",["inherit","i-bem__collection"],function(t,e,n){function i(t,e,n){return t.map(function(t){return t[e].apply(t,n)})}function o(t){return function(){return new s(i(this,t,arguments))}}function r(t){return function(){var e=[];return i(this,t,arguments).forEach(function(t){t.forEach(function(t){e.push(t)})}),new s(e)}}var s=e(n,{findChildBlock:o("findChildBlock"),findChildBlocks:r("findChildBlocks"),findParentBlock:o("findParentBlock"),findParentBlocks:r("findParentBlocks"),findMixedBlock:o("findMixedBlock"),findMixedBlocks:r("findMixedBlocks"),findChildElem:o("findChildElem"),findChildElems:r("findChildElems"),findParentElem:o("findParentElem"),findParentElems:r("findParentElems"),findMixedElem:o("findMixedElem"),findMixedElems:r("findMixedElems")});t(s)}),modules.define("i-bem__collection",["inherit"],function(t,e){function n(t){return function(){var e=arguments;return this._entities.forEach(function(n){n[t].apply(n,e)}),this}}function i(t){return function(){var e=this._entities;return e[t].apply(e,arguments)}}function o(t,e){return function(){var n=arguments;return this._entities[t](function(t){return t[e].apply(t,n)})}}var r=e({__constructor:function(t){var e=this._entities=[],n={};(Array.isArray(t)?t:a.call(arguments)).forEach(function(t){n[t._uniqId]||(n[t._uniqId]=!0,e.push(t))})},setMod:n("setMod"),delMod:n("delMod"),toggleMod:n("toggleMod"),everyHasMod:o("every","hasMod"),someHasMod:o("some","hasMod"),get:function(t){return this._entities[t]},forEach:i("forEach"),map:i("map"),reduce:i("reduce"),reduceRight:i("reduceRight"),filter:function(){return new this.__self(i("filter").apply(this,arguments))},some:i("some"),every:i("every"),has:function(t){return this._entities.indexOf(t)>-1},find:function(t,e){e||(e=this);for(var n,i=this._entities,o=0;n=i[o];)if(t.call(e,i[o],o++,this))return n;return null},concat:function(){for(var t,e=0,n=arguments.length,i=[];e<n;)t=arguments[e++],i.push(t instanceof r?t._entities:t);return new r(s.apply(this._entities,i))},size:function(){return this._entities.length},toArray:function(){return this._entities.slice()}}),s=Array.prototype.concat,a=Array.prototype.slice;t(r)}),modules.define("events",["identify","inherit","functions"],function(t,e,n,i){var o,r="__"+ +new Date+"storage",s=n({__constructor:function(t,e){this.type=t,this.target=e,this.data=o,this._isDefaultPrevented=!1,this._isPropagationStopped=!1},preventDefault:function(){this._isDefaultPrevented=!0},isDefaultPrevented:function(){return this._isDefaultPrevented},stopPropagation:function(){this._isPropagationStopped=!0},isPropagationStopped:function(){return this._isPropagationStopped}}),a=n({on:function(t,n,s,a,c){if("string"==typeof t){i.isFunction(n)&&(a=s,s=n,n=o);for(var d,u,f,l,h=e(s,a),m=this[r]||(this[r]={}),p=t.split(" "),_=0;d=p[_++];)l=m[d]||(m[d]={ids:{},list:{}}),h in l.ids||(u=l.list,f={fn:s,data:n,ctx:a,special:c},u.last?(u.last.next=f,f.prev=u.last):u.first=f,l.ids[h]=u.last=f)}else for(var v in t)t.hasOwnProperty(v)&&this.on(v,t[v],n,c);return this},once:function(t,e,n,i){return this.on(t,e,n,i,{once:!0})},un:function(t,n,i){if("string"==typeof t||"undefined"==typeof t){var o=this[r];if(o)if(t){for(var s,a=t.split(" "),c=0;t=a[c++];)if(s=o[t])if(n){var d=e(n,i),u=s.ids;if(d in u){var f=s.list,l=u[d],h=l.prev,m=l.next;h?h.next=m:l===f.first&&(f.first=m),m?m.prev=h:l===f.last&&(f.last=h),delete u[d]}}else delete this[r][t]}else delete this[r]}else for(var p in t)t.hasOwnProperty(p)&&this.un(p,t[p],n);return this},emit:function(t,e){var n=this[r],i=!1;if(n)for(var o,a,c=["string"==typeof t?t:t.type,"*"],d=0;o=c[d++];)if(a=n[o])for(var u,f=a.list.first,l=a.list.last;f&&(i||(i=!0,"string"==typeof t&&(t=new s(t)),t.target||(t.target=this)),t.data=f.data,u=f.fn.apply(f.ctx||this,arguments),u===!1&&(t.preventDefault(),t.stopPropagation()),f.special&&f.special.once&&this.un(t.type,f.fn,f.ctx),f!==l);)f=f.next;return this}});t({Emitter:a,Event:s})}),modules.define("objects",function(t){var e=Object.prototype.hasOwnProperty;t({extend:function(t,n){("object"!=typeof t||null===t)&&(t={});for(var i=1,o=arguments.length;i<o;i++){var r=arguments[i];if(r)for(var s in r)e.call(r,s)&&(t[s]=r[s])}return t},isEmpty:function(t){for(var n in t)if(e.call(t,n))return!1;return!0},each:function(t,n,i){for(var o in t)e.call(t,o)&&(i?n.call(i,t[o],o):n(t[o],o))}})});
//# sourceMappingURL=bundle.min.js.map
